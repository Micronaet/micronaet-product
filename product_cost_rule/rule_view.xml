<?xml version="1.0"?>
<openerp>
    <data>
        <!--product.cost.transport-->
        <record model="ir.ui.view" id="view_product_cost_transport_form">
            <field name="name">product.cost.transport.form</field>
            <field name="model">product.cost.transport</field>
            <field name="arch" type="xml">
                <form string="Cost transport" version="7.0">        
                    <sheet>
                        <group col="4" colspan="4">
                            <field name="name" />
                            <newline/>
                            <field name="cost" />
                            <field name="cube_meter" />
                            <separator string="Note" colspan="4" />
                            <field name="note" colspan="4" nolabel="1" />
                        </group>
                    </sheet>        
                </form>
            </field>
        </record>
        <record model="ir.ui.view" id="view_product_cost_transport_tree">
            <field name="name">product.cost.transport.tree</field>
            <field name="model">product.cost.transport</field>
            <field name="arch" type="xml">
                <tree string="Cost transport" version="7.0">        
                    <field name="name" />
                    <field name="cost" />
                    <field name="cube_meter" />
                    <field name="note" colspan="4" nolabel="1" />
                </tree>
            </field>
        </record>
        <record model="ir.actions.act_window" id="action_product_cost_transport">
            <field name="name">Transport</field>
            <field name="res_model">product.cost.transport</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_product_cost_transport_tree"/>
            <field name="context">{}</field>
            <field name="domain">[]</field>
        </record>
        
        <!--product.cost.method-->
        <record model="ir.ui.view" id="view_product_cost_method_form">
            <field name="name">product.cost.method.form</field>
            <field name="model">product.cost.method</field>
            <field name="arch" type="xml">
                <form string="Cost method" version="7.0">        
                    <sheet>
                        <group col="4" colspan="4">
                            <field name="name" />
                            <newline/>
                            <field name="transport_id" />
                            <field name="category" invisible="context.get('product_embedded', False)"/>
                            <separator string="Rule" colspan="4" />
                            <field name="rule_ids" colspan="4" nolabel="1">
                                <tree string="Rule" editable="bottom">
                                    <field name="sequence" />
                                    <field name="name" />
                                    <field name="operation" />
                                    <field name="mode" attrs="{'readonly': [('operation','in',('duty', 'exchange'))]}"/>
                                    <field name="value" attrs="{'readonly': ['|',('operation','in',('duty', 'exchange')),('mode','=','multi')]}"/>
                                    <field name="text_value" attrs="{'readonly': ['|',('operation','in',('duty', 'exchange')),('mode','!=','multi')]}"/>
                                    <field name="note" />
                                </tree>
                            </field>
                            <separator string="Note" colspan="4" />
                            <field name="note" colspan="4" nolabel="1" />
                        </group>
                    </sheet>        
                </form>
            </field>
        </record>
        <record model="ir.ui.view" id="view_product_cost_method_tree">
            <field name="name">product.cost.method.tree</field>
            <field name="model">product.cost.method</field>
            <field name="arch" type="xml">
                <tree string="Cost method" version="7.0">        
                    <field name="name" />
                    <field name="category" />
                    <field name="transport_id" />
                    <field name="note" />
                </tree>
            </field>
        </record>
        <record model="ir.ui.view" id="view_product_cost_method_search">
            <field name="name">product.cost.method.search</field>
            <field name="model">product.cost.method</field>
            <field name="arch" type="xml">
                <search string="Cost method" version="7.0">        
                    <field name="name" />
                    <field name="category" />
                    <field name="transport_id" />
                    <group expand="0" string="Group By...">
                        <filter name="group_category" string="Category" context="{'group_by': 'category_id'}"/>
                        <filter name="group_transport" string="Transport" context="{'group_by': 'transport_id'}"/>
                    </group>                
                </search>
            </field>
        </record>
        <record model="ir.actions.act_window" id="action_product_cost_method">
            <field name="name">Cost method</field>
            <field name="res_model">product.cost.method</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_product_cost_method_tree"/>
            <field name="search_view_id" ref="view_product_cost_method_search"/>            
            <field name="context">{}</field>
            <field name="domain">[]</field>
        </record>

        <record model="ir.ui.view" id="view_product_product_cost_form">
            <field name="name">product.product.form</field>
            <field name="model">product.product</field>
            <field name="priority" eval="60" />
            <field name="arch" type="xml">
                <form string="String" version="7.0">        
                    <sheet>
                        <group col="4" colspan="4">
                            <field name="name" />
                            <field name="default_code" />
                            <field name="duty_id" />
                            <field name="duty_code" />
                            <field name="first_supplier_id" />
                            <group col="6" colspan="4">
                                <group col="2" colspan="2">
                                    <separator string="F / Company" colspan="2"/>
                                    <field name="supplier_cost" />
                                    <field name="company_method_id" context="{'default_category':'company', 'product_embedded':True}" domain="[('category','=','company')]" />
                                    <button name="calculate_cost_method" string="Generate f/company" type="object" attrs="{'invisible': [('company_method_id','=',False)]}" />
                                    <field name="company_calc" />
                                    <field name="company_calc_error" attrs="{'invisible': [('company_calc_error','=',False)]}" />
                                </group>
                                
                                <group col="2" colspan="2">
                                    <separator string="F / Customer" colspan="2"/>
                                    <field name="standard_price" />
                                    <field name="customer_method_id" context="{'default_category':'customer', 'product_embedded':True}" domain="[('category','=','customer')]" />
                                    <button name="calculate_cost_method" string="Generate f/customer" type="object" attrs="{'invisible': [('customer_method_id','=',False)]}"/>
                                    <field name="customer_calc" />
                                    <field name="customer_calc_error" attrs="{'invisible': [('customer_calc_error','=',False)]}" />
                                </group>            
                                                    
                                <group col="2" colspan="2">
                                    <separator string="Pricelist" colspan="2"/>
                                    <field name="customer_cost" />
                                    <field name="pricelist_method_id" context="{'default_category':'pricelist', 'product_embedded':True}" domain="[('category','=','pricelist')]" />
                                    <button name="calculate_cost_method" string="Generate pricelist" type="object" attrs="{'invisible': [('pricelist_method_id','=',False)]}"/>
                                    <field name="lst_price" />
                                    <field name="pricelist_calc" />
                                    <field name="pricelist_calc_error" attrs="{'invisible': [('pricelist_calc_error','=',False)]}" />
                                </group>                                
                            </group>                            
                        </group>
                    </sheet>        
                </form>
            </field>
        </record>
        <record model="ir.ui.view" id="view_product_product_cost_tree">
            <field name="name">product.product.tree</field>
            <field name="model">product.product</field>
            <field name="priority" eval="60" />
            <field name="arch" type="xml">
                <tree string="String" version="7.0">        
                    <field name="name" />
                    <field name="default_code" />
                    <field name="supplier_cost" />
                    <field name="company_method_id" />
                    <button name="calculate_cost_method" string="Generate f/company" type="object" attrs="{'invisible': [('company_method_id','=',False)]}" />
                    <field name="standard_price" />
                    <field name="customer_method_id" />
                    <button name="calculate_cost_method" string="Generate f/customer" type="object" attrs="{'invisible': [('customer_method_id','=',False)]}"/>
                    <field name="customer_cost" />
                    <field name="pricelist_method_id" />
                    <button name="calculate_cost_method" string="Generate pricelist" type="object" attrs="{'invisible': [('pricelist_method_id','=',False)]}"/>
                    <field name="lst_price" />
                </tree>
            </field>
        </record>
        <record model="ir.ui.view" id="view_product_product_cost_search">
            <field name="name">product.product.search</field>
            <field name="model">product.product</field>
            <field name="priority" eval="60" />
            <field name="arch" type="xml">
                <search string="Cost method" version="7.0">        
                    <field name="name" />
                    <field name="default_code" />
                    
                    <field name="company_method_id" />
                    <field name="customer_method_id" />
                    <field name="pricelist_method_id" />
                    
                    <group expand="0" string="Group By...">
                        <filter name="group_company" string="Company method" context="{'group_by': 'company_method_id'}"/>
                        <filter name="group_company" string="Customer method" context="{'group_by': 'customer_method_id'}"/>
                        <filter name="group_company" string="Pricelist method" context="{'group_by': 'pricelist_method_id'}"/>
                    </group>                
                </search>
            </field>
        </record>        
        <record model="ir.actions.act_window" id="action_product_product_cost_tree">
            <field name="name">Cost product</field>
            <field name="res_model">product.product</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_product_product_cost_tree"/>
            <field name="search_view_id" ref="view_product_product_cost_search"/>
            <field name="context">{'form_view_ref': 'product_cost_rule.view_product_product_cost_form'}</field>
            <field name="domain">[]</field>
        </record>
        
        <!--MENU STRUCTURE:-->
        <menuitem 
            parent="stock.menu_stock_configuration" 
            id="menu_product_cost_root" 
            name="Cost calc method"
            />
            <menuitem
                parent="menu_product_cost_root" 
                id="menu_product_product_cost" 
                action="action_product_product_cost_tree"
                sequence="10"
                />
            <menuitem
                parent="menu_product_cost_root" 
                id="menu_product_cost_method" 
                action="action_product_cost_method"
                sequence="20"
                />
            <menuitem
                parent="menu_product_cost_root" 
                id="menu_product_cost_transport" 
                action="action_product_cost_transport"
                sequence="30"
                />
    </data>
</openerp>

